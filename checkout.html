<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Ø§Ù„Ø¯ÙØ¹ - Take Two</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body { text-align:center; padding:40px; font-family:'Cairo',sans-serif; background:#f7f9fa; }
    .card { max-width:500px; margin:auto; background:#fff; padding:30px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
    input { width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:6px; }
    button { background:#27ae60; color:white; border:none; padding:12px 25px; border-radius:6px; cursor:pointer; font-weight:bold; }
    button:hover { background:#219150; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹</h2>
    <p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ø¨Ø£Ù…Ø§Ù†.</p>

    <input id="full_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required />
    <input id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" type="email" required />
    <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required />
    <input id="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡" required />

    <button onclick="startPayment()">Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¢Ù†</button>
  </div>

  <script>
    const API_KEY = "YOUR_PAYMOB_API_KEY";
    const INTEGRATION_ID = "YOUR_INTEGRATION_ID";

    async function startPayment() {
      const name = document.getElementById("full_name").value;
      const email = document.getElementById("email").value;
      const phone = document.getElementById("phone").value;
      const amount = Number(document.getElementById("amount").value) * 100; // Ø¨Ø§Ù„Ù…Ù„ÙŠÙ…

      // 1ï¸âƒ£ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Token
      const auth = await fetch("https://accept.paymob.com/api/auth/tokens", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ api_key: API_KEY })
      });
      const authData = await auth.json();
      const token = authData.token;

      // 2ï¸âƒ£ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨
      const order = await fetch("https://accept.paymob.com/api/ecommerce/orders", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          auth_token: token,
          delivery_needed: "false",
          amount_cents: amount,
          currency: "EGP",
          items: []
        })
      });
      const orderData = await order.json();

      // 3ï¸âƒ£ Ø¥Ù†Ø´Ø§Ø¡ Payment Key
      const paymentKeyReq = await fetch("https://accept.paymob.com/api/acceptance/payment_keys", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          auth_token: token,
          amount_cents: amount,
          expiration: 3600,
          order_id: orderData.id,
          billing_data: {
            apartment: "NA",
            email,
            floor: "NA",
            first_name: name.split(" ")[0],
            last_name: name.split(" ")[1] || "",
            phone_number: phone,
            street: "NA",
            building: "NA",
            shipping_method: "NA",
            postal_code: "NA",
            city: "Cairo",
            country: "EG",
            state: "Cairo"
          },
          currency: "EGP",
          integration_id: INTEGRATION_ID
        })
      });
      const paymentKeyData = await paymentKeyReq.json();
      const paymentToken = paymentKeyData.token;

      // 4ï¸âƒ£ ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ (Iframe Ø£Ùˆ Redirect)
      window.location.href = `https://accept.paymob.com/api/acceptance/iframes/123456?payment_token=${paymentToken}`;
      // ğŸ”¸ Ø§Ø³ØªØ¨Ø¯Ù„ 123456 Ø¨Ù€ Ø±Ù‚Ù… Ø§Ù„Ù€ iframe Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Paymob
    }
  </script>
</body>
</html>
